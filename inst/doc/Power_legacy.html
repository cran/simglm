<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2018-07-25" />

<title>Power with simglm - legacy code</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Power with simglm - legacy code</h1>
<h4 class="date"><em>2018-07-25</em></h4>



<div id="power-analysis-with-simglm" class="section level1">
<h1>Power Analysis with simglm</h1>
<p>The <code>simglm</code> package allows the ability to conduct a power analysis through simulation. This will be particularly helpful with multilevel models and generalized linear models. To show the process, we will start with basic regression models.</p>
<div id="single-level-power-analysis" class="section level2">
<h2>Single Level Power Analysis</h2>
<p>Let’s look at a simple single level regression example to get started:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">fixed &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>act <span class="op">+</span><span class="st"> </span>diff <span class="op">+</span><span class="st"> </span>numCourse <span class="op">+</span><span class="st"> </span>act<span class="op">:</span>numCourse</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">fixed_param &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.1</span>, <span class="fl">0.6</span>, <span class="fl">0.9</span>, <span class="fl">1.1</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">cov_param &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">dist_fun =</span> <span class="kw">c</span>(<span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>),</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">                  <span class="dt">var_type =</span> <span class="kw">c</span>(<span class="st">&quot;single&quot;</span>, <span class="st">&quot;single&quot;</span>, <span class="st">&quot;single&quot;</span>),</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">                  <span class="dt">opts =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">                              <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">                              <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">n &lt;-<span class="st"> </span><span class="dv">150</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">error_var &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">with_err_gen &lt;-<span class="st"> 'rnorm'</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">pow_param &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'(Intercept)'</span>, <span class="st">'act'</span>, <span class="st">'diff'</span>, <span class="st">'numCourse'</span>)</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">alpha &lt;-<span class="st"> </span><span class="fl">.01</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13">pow_dist &lt;-<span class="st"> &quot;t&quot;</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14">pow_tail &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15">replicates &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16">power_out &lt;-<span class="st"> </span><span class="kw">sim_pow</span>(<span class="dt">fixed =</span> fixed, <span class="dt">fixed_param =</span> fixed_param, </a>
<a class="sourceLine" id="cb1-17" data-line-number="17">                     <span class="dt">cov_param =</span> cov_param, <span class="dt">n =</span> n, <span class="dt">error_var =</span> error_var,</a>
<a class="sourceLine" id="cb1-18" data-line-number="18">                     <span class="dt">with_err_gen =</span> with_err_gen, <span class="dt">data_str =</span> <span class="st">&quot;single&quot;</span>,</a>
<a class="sourceLine" id="cb1-19" data-line-number="19">                     <span class="dt">pow_param =</span> pow_param, <span class="dt">alpha =</span> alpha,</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">                     <span class="dt">pow_dist =</span> pow_dist, <span class="dt">pow_tail =</span> pow_tail, </a>
<a class="sourceLine" id="cb1-21" data-line-number="21">                     <span class="dt">replicates =</span> replicates)</a></code></pre></div>
<p>Much of the output here is the same from the <code>sim_reg</code> function. The additional arguments, <code>pow_param</code> represents the terms to conduct a power analysis for and must be a subset of the <code>fixed</code> argument, <code>alpha</code> represents the per term level of significance, <code>pow_dist</code> represents the sampling distribution to refer to, either ‘z’ or ‘t’, <code>pow_tail</code> represents whether a one or two tailed hypothesis is being tested, and <code>replicates</code> represents the number of simulations to conduct. Note, to do a power analysis for the intercept, ‘(Intercept)’ must be used. By default, if pow_param is not specified power is conducted for all terms.</p>
<p>Finally, looking at the output from the above call:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">head</span>(power_out)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 9
##   term  avg_test_stat sd_test_stat avg_std_err sd_std_err power num_reject
##   &lt;chr&gt;         &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
## 1 (Int~         0.474        0.352       0.373     0.0194     0          0
## 2 act           1.09         0.188       0.189     0.0151     0          0
## 3 diff          0.581        0.163       0.189     0.0160     0          0
## 4 numC~         0.955        0.345       0.380     0.0291     0          0
## # ... with 2 more variables: num_repl &lt;dbl&gt;, data &lt;list&gt;</code></pre>
<p>The output contains the variable name, the average test statistic, the standard deviation of the test statistic, the power rate, the number of null hypotheses rejects, and the total number of replications. Increasing the number of replications would increase the precision of the power analysis, however may significantly increase the computational time.</p>
<div id="standardized-coefficients" class="section level3">
<h3>Standardized Coefficients</h3>
<p>By default, the <code>simglm</code> package uses unstandardized regression coefficients when doing the simulation. A way to use standardized coefficients however, would be to generate standardized variables. For example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">fixed &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>act <span class="op">+</span><span class="st"> </span>diff <span class="op">+</span><span class="st"> </span>numCourse <span class="op">+</span><span class="st"> </span>act<span class="op">:</span>numCourse</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">fixed_param &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.25</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">cov_param &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">dist_fun =</span> <span class="kw">c</span>(<span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>),</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">                  <span class="dt">var_type =</span> <span class="kw">c</span>(<span class="st">&quot;single&quot;</span>, <span class="st">&quot;single&quot;</span>, <span class="st">&quot;single&quot;</span>),</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">                  <span class="dt">opts =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">                              <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">                              <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">n &lt;-<span class="st"> </span><span class="dv">150</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9">error_var &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10">with_err_gen &lt;-<span class="st"> 'rnorm'</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11">pow_param &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'(Intercept)'</span>, <span class="st">'act'</span>, <span class="st">'diff'</span>, <span class="st">'numCourse'</span>)</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">alpha &lt;-<span class="st"> </span><span class="fl">.01</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13">pow_dist &lt;-<span class="st"> &quot;t&quot;</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14">pow_tail &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15">replicates &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16">power_out &lt;-<span class="st"> </span><span class="kw">sim_pow</span>(<span class="dt">fixed =</span> fixed, <span class="dt">fixed_param =</span> fixed_param, </a>
<a class="sourceLine" id="cb4-17" data-line-number="17">                     <span class="dt">cov_param =</span> cov_param,<span class="dt">n =</span> n, <span class="dt">error_var =</span> error_var,</a>
<a class="sourceLine" id="cb4-18" data-line-number="18">                     <span class="dt">with_err_gen =</span> with_err_gen, <span class="dt">data_str =</span> <span class="st">&quot;single&quot;</span>,</a>
<a class="sourceLine" id="cb4-19" data-line-number="19">                     <span class="dt">pow_param =</span> pow_param, <span class="dt">alpha =</span> alpha,</a>
<a class="sourceLine" id="cb4-20" data-line-number="20">                     <span class="dt">pow_dist =</span> pow_dist, <span class="dt">pow_tail =</span> pow_tail, </a>
<a class="sourceLine" id="cb4-21" data-line-number="21">                     <span class="dt">replicates =</span> replicates)</a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="kw">head</span>(power_out)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 9
##   term  avg_test_stat sd_test_stat avg_std_err sd_std_err power num_reject
##   &lt;chr&gt;         &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
## 1 (Int~         0.198       0.0783      0.0823    0.00457     0          0
## 2 act           0.401       0.0828      0.0836    0.00778     0          0
## 3 diff          0.245       0.0880      0.0833    0.00697     0          0
## 4 numC~         0.701       0.0751      0.0839    0.00588     0          0
## # ... with 2 more variables: num_repl &lt;dbl&gt;, data &lt;list&gt;</code></pre>
</div>
<div id="varying-arguments" class="section level3">
<h3>Varying Arguments</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">fixed &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>act <span class="op">+</span><span class="st"> </span>diff <span class="op">+</span><span class="st"> </span>numCourse <span class="op">+</span><span class="st"> </span>act<span class="op">:</span>numCourse</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">fixed_param &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.1</span>, <span class="fl">0.6</span>, <span class="fl">0.9</span>, <span class="fl">1.1</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">cov_param &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">dist_fun =</span> <span class="kw">c</span>(<span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>), </a>
<a class="sourceLine" id="cb6-4" data-line-number="4">                  <span class="dt">var_type =</span> <span class="kw">c</span>(<span class="st">&quot;single&quot;</span>, <span class="st">&quot;single&quot;</span>, <span class="st">&quot;single&quot;</span>),</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">                  <span class="dt">opts =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">                              <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">                              <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">n &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9">error_var &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10">with_err_gen &lt;-<span class="st"> 'rnorm'</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11">pow_param &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'(Intercept)'</span>, <span class="st">'act'</span>, <span class="st">'diff'</span>, <span class="st">'numCourse'</span>)</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">alpha &lt;-<span class="st"> </span><span class="fl">.01</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13">pow_dist &lt;-<span class="st"> &quot;t&quot;</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14">pow_tail &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15">replicates &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16">terms_vary &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">100</span>), <span class="dt">error_var =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb6-17" data-line-number="17">                   <span class="dt">fixed_param =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.1</span>, <span class="fl">0.6</span>, <span class="fl">0.9</span>, <span class="fl">1.1</span>), </a>
<a class="sourceLine" id="cb6-18" data-line-number="18">                                      <span class="kw">c</span>(<span class="fl">0.6</span>, <span class="fl">1.1</span>, <span class="fl">0.6</span>, <span class="fl">0.9</span>, <span class="fl">1.1</span>)),</a>
<a class="sourceLine" id="cb6-19" data-line-number="19">                <span class="dt">cov_param =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">dist_fun =</span> <span class="kw">c</span>(<span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>),</a>
<a class="sourceLine" id="cb6-20" data-line-number="20">                                       <span class="dt">mean =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">sd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb6-21" data-line-number="21">                                  <span class="dt">var_type =</span> <span class="kw">c</span>(<span class="st">&quot;single&quot;</span>, <span class="st">&quot;single&quot;</span>, <span class="st">&quot;single&quot;</span>)),</a>
<a class="sourceLine" id="cb6-22" data-line-number="22">                                  <span class="kw">list</span>(<span class="dt">dist_fun =</span> <span class="kw">c</span>(<span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>),</a>
<a class="sourceLine" id="cb6-23" data-line-number="23">                                       <span class="dt">mean =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">sd =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb6-24" data-line-number="24">                                  <span class="dt">var_type =</span> <span class="kw">c</span>(<span class="st">&quot;single&quot;</span>, <span class="st">&quot;single&quot;</span>, <span class="st">&quot;single&quot;</span>))</a>
<a class="sourceLine" id="cb6-25" data-line-number="25">                                  )</a>
<a class="sourceLine" id="cb6-26" data-line-number="26">                   )</a>
<a class="sourceLine" id="cb6-27" data-line-number="27">power_out &lt;-<span class="st"> </span><span class="kw">sim_pow</span>(<span class="dt">fixed =</span> fixed, <span class="dt">fixed_param =</span> fixed_param, </a>
<a class="sourceLine" id="cb6-28" data-line-number="28">                     <span class="dt">cov_param =</span> cov_param,</a>
<a class="sourceLine" id="cb6-29" data-line-number="29">                     <span class="dt">n =</span> n, <span class="dt">error_var =</span> error_var, <span class="dt">with_err_gen =</span> with_err_gen, </a>
<a class="sourceLine" id="cb6-30" data-line-number="30">                     <span class="dt">data_str =</span> <span class="st">&quot;single&quot;</span>, <span class="dt">pow_param =</span> pow_param, <span class="dt">alpha =</span> alpha,</a>
<a class="sourceLine" id="cb6-31" data-line-number="31">                     <span class="dt">pow_dist =</span> pow_dist, <span class="dt">pow_tail =</span> pow_tail, </a>
<a class="sourceLine" id="cb6-32" data-line-number="32">                     <span class="dt">replicates =</span> replicates, <span class="dt">terms_vary =</span> terms_vary)</a></code></pre></div>
</div>
<div id="model-misspecification" class="section level3">
<h3>Model Misspecification</h3>
<p>It is also possible to specify a model different than the generating model for evaluation of power. This may be useful if it is thought another variable is important in explaining variation, however due to design issues is not possible to collect this variable. As a result, there would likely be additional variation due to this variable that will not be able to be explained. Building this into the generating model can help provide additional information about the impact on power.</p>
<p>An example using single level power analysis is shown below.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">fixed &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>act <span class="op">+</span><span class="st"> </span>diff <span class="op">+</span><span class="st"> </span>numCourse <span class="op">+</span><span class="st"> </span>act<span class="op">:</span>numCourse</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">fixed_param &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.1</span>, <span class="fl">0.6</span>, <span class="fl">0.9</span>, <span class="fl">1.1</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">cov_param &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">dist_fun =</span> <span class="kw">c</span>(<span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>),</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">                  <span class="dt">var_type =</span> <span class="kw">c</span>(<span class="st">&quot;single&quot;</span>, <span class="st">&quot;single&quot;</span>, <span class="st">&quot;single&quot;</span>),</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">                  <span class="dt">opts =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">                              <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">                              <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">n &lt;-<span class="st"> </span><span class="dv">150</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9">error_var &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10">with_err_gen &lt;-<span class="st"> 'rnorm'</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11">pow_param &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'(Intercept)'</span>, <span class="st">'act'</span>, <span class="st">'diff'</span>, <span class="st">'numCourse'</span>)</a>
<a class="sourceLine" id="cb7-12" data-line-number="12">alpha &lt;-<span class="st"> </span><span class="fl">.01</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13">pow_dist &lt;-<span class="st"> &quot;t&quot;</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14">pow_tail &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15">replicates &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"></a>
<a class="sourceLine" id="cb7-17" data-line-number="17">lm_fit_mod &lt;-<span class="st"> </span>sim_data <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>act <span class="op">+</span><span class="st"> </span>diff</a>
<a class="sourceLine" id="cb7-18" data-line-number="18"></a>
<a class="sourceLine" id="cb7-19" data-line-number="19">power_out &lt;-<span class="st"> </span><span class="kw">sim_pow</span>(<span class="dt">fixed =</span> fixed, <span class="dt">fixed_param =</span> fixed_param, </a>
<a class="sourceLine" id="cb7-20" data-line-number="20">                     <span class="dt">cov_param =</span> cov_param, <span class="dt">n =</span> n, <span class="dt">error_var =</span> error_var,</a>
<a class="sourceLine" id="cb7-21" data-line-number="21">                     <span class="dt">with_err_gen =</span> with_err_gen, <span class="dt">data_str =</span> <span class="st">&quot;single&quot;</span>,</a>
<a class="sourceLine" id="cb7-22" data-line-number="22">                     <span class="dt">pow_param =</span> pow_param, <span class="dt">alpha =</span> alpha,</a>
<a class="sourceLine" id="cb7-23" data-line-number="23">                     <span class="dt">pow_dist =</span> pow_dist, <span class="dt">pow_tail =</span> pow_tail, </a>
<a class="sourceLine" id="cb7-24" data-line-number="24">                     <span class="dt">replicates =</span> replicates, <span class="dt">lm_fit_mod =</span> lm_fit_mod)</a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="kw">head</span>(power_out)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 9
##   term  avg_test_stat sd_test_stat avg_std_err sd_std_err power num_reject
##   &lt;chr&gt;         &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
## 1 (Int~         0.443        0.434       0.414     0.0286     0          0
## 2 act           1.07         0.229       0.209     0.0168     0          0
## 3 diff          0.605        0.187       0.208     0.0197     0          0
## # ... with 2 more variables: num_repl &lt;dbl&gt;, data &lt;list&gt;</code></pre>
<p>You’ll notice, compared to above, the power is somewhat reduced for the other three fixed effects when not modeling the <code>numCourse</code> variable. You can also build in the <code>lm_fit_mod</code> argument into the design via the <code>terms_vary</code> argument.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">fixed &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>act <span class="op">+</span><span class="st"> </span>diff <span class="op">+</span><span class="st"> </span>numCourse <span class="op">+</span><span class="st"> </span>act<span class="op">:</span>numCourse</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">fixed_param &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.1</span>, <span class="fl">0.6</span>, <span class="fl">0.9</span>, <span class="fl">1.1</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">cov_param &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">dist_fun =</span> <span class="kw">c</span>(<span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>),</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">                  <span class="dt">var_type =</span> <span class="kw">c</span>(<span class="st">&quot;single&quot;</span>, <span class="st">&quot;single&quot;</span>, <span class="st">&quot;single&quot;</span>),</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">                  <span class="dt">opts =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">                              <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">                              <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">n &lt;-<span class="st"> </span><span class="dv">150</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9">error_var &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10">with_err_gen &lt;-<span class="st"> 'rnorm'</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11">pow_param &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'(Intercept)'</span>, <span class="st">'act'</span>, <span class="st">'diff'</span>, <span class="st">'numCourse'</span>)</a>
<a class="sourceLine" id="cb9-12" data-line-number="12">alpha &lt;-<span class="st"> </span><span class="fl">.01</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13">pow_dist &lt;-<span class="st"> &quot;t&quot;</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14">pow_tail &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15">replicates &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"></a>
<a class="sourceLine" id="cb9-17" data-line-number="17">terms_vary &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">100</span>), <span class="dt">error_var =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>),</a>
<a class="sourceLine" id="cb9-18" data-line-number="18">                   <span class="dt">fixed_param =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">1.1</span>, <span class="fl">0.6</span>, <span class="fl">0.9</span>, <span class="fl">1.1</span>), </a>
<a class="sourceLine" id="cb9-19" data-line-number="19">                                      <span class="kw">c</span>(<span class="fl">0.6</span>, <span class="fl">1.1</span>, <span class="fl">0.6</span>, <span class="fl">0.9</span>, <span class="fl">1.1</span>)),</a>
<a class="sourceLine" id="cb9-20" data-line-number="20">                <span class="dt">lm_fit_mod =</span> <span class="kw">list</span>(sim_data <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>act <span class="op">+</span><span class="st"> </span>diff, </a>
<a class="sourceLine" id="cb9-21" data-line-number="21">                                  sim_data <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>act)</a>
<a class="sourceLine" id="cb9-22" data-line-number="22">)</a>
<a class="sourceLine" id="cb9-23" data-line-number="23"></a>
<a class="sourceLine" id="cb9-24" data-line-number="24">power_out &lt;-<span class="st"> </span><span class="kw">sim_pow</span>(<span class="dt">fixed =</span> fixed, <span class="dt">fixed_param =</span> fixed_param, </a>
<a class="sourceLine" id="cb9-25" data-line-number="25">                     <span class="dt">cov_param =</span> cov_param, <span class="dt">n =</span> n, <span class="dt">error_var =</span> error_var,</a>
<a class="sourceLine" id="cb9-26" data-line-number="26">                     <span class="dt">with_err_gen =</span> with_err_gen, <span class="dt">data_str =</span> <span class="st">&quot;single&quot;</span>,</a>
<a class="sourceLine" id="cb9-27" data-line-number="27">                     <span class="dt">pow_param =</span> pow_param, <span class="dt">alpha =</span> alpha,</a>
<a class="sourceLine" id="cb9-28" data-line-number="28">                     <span class="dt">pow_dist =</span> pow_dist, <span class="dt">pow_tail =</span> pow_tail, </a>
<a class="sourceLine" id="cb9-29" data-line-number="29">                     <span class="dt">replicates =</span> replicates, <span class="dt">terms_vary =</span> terms_vary)</a>
<a class="sourceLine" id="cb9-30" data-line-number="30"><span class="kw">head</span>(power_out)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 13
## # Groups:   term, n, error_var, fixed_param [3]
##   term      n error_var fixed_param lm_fit_mod avg_test_stat sd_test_stat
##   &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;       &lt;fct&gt;              &lt;dbl&gt;        &lt;dbl&gt;
## 1 (Int~    20         5 0.5,1.1,0.~ ~,sim_dat~         0.453        0.815
## 2 (Int~    20         5 0.5,1.1,0.~ ~,sim_dat~         0.584        0.701
## 3 (Int~    20         5 0.6,1.1,0.~ ~,sim_dat~         0.616        0.793
## 4 (Int~    20         5 0.6,1.1,0.~ ~,sim_dat~         0.499        0.893
## 5 (Int~    20        10 0.5,1.1,0.~ ~,sim_dat~         0.521        0.886
## 6 (Int~    20        10 0.5,1.1,0.~ ~,sim_dat~         0.434        0.903
## # ... with 6 more variables: avg_std_err &lt;dbl&gt;, sd_std_err &lt;dbl&gt;,
## #   power &lt;dbl&gt;, num_reject &lt;dbl&gt;, num_repl &lt;dbl&gt;, data &lt;list&gt;</code></pre>
</div>
</div>
<div id="nested-data" class="section level2">
<h2>Nested Data</h2>
<p>Extending the power analysis to nested data is fairly straightforward. Below is a three level example</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">fixed &lt;-<span class="st"> </span><span class="er">~</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>diff <span class="op">+</span><span class="st"> </span>act <span class="op">+</span><span class="st"> </span>actClust <span class="op">+</span><span class="st"> </span>time<span class="op">:</span>act</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">random &lt;-<span class="st"> </span><span class="er">~</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>time</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">random3 &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>time</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">fixed_param &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="fl">2.3</span>, <span class="dv">7</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">random_param &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">random_var =</span> <span class="kw">c</span>(<span class="dv">7</span>, <span class="dv">4</span>), <span class="dt">rand_gen =</span> <span class="st">'rnorm'</span>)</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">random_param3 &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">random_var =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>), <span class="dt">rand_gen =</span> <span class="st">'rnorm'</span>)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">cov_param &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">dist_fun =</span> <span class="kw">c</span>(<span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>),</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">                  <span class="dt">var_type =</span> <span class="kw">c</span>(<span class="st">&quot;level1&quot;</span>, <span class="st">&quot;level2&quot;</span>, <span class="st">&quot;level3&quot;</span>),</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">                  <span class="dt">opts =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="fl">1.5</span>),</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">                              <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">4</span>),</a>
<a class="sourceLine" id="cb11-11" data-line-number="11">                              <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb11-12" data-line-number="12">k &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13">n &lt;-<span class="st"> </span><span class="dv">45</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14">p &lt;-<span class="st"> </span><span class="dv">8</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15">error_var &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16">with_err_gen &lt;-<span class="st"> 'rnorm'</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17">data_str &lt;-<span class="st"> &quot;long&quot;</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18">pow_param &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'time'</span>, <span class="st">'diff'</span>, <span class="st">'act'</span>, <span class="st">'actClust'</span>)</a>
<a class="sourceLine" id="cb11-19" data-line-number="19">alpha &lt;-<span class="st"> </span><span class="fl">.01</span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20">pow_dist &lt;-<span class="st"> &quot;z&quot;</span></a>
<a class="sourceLine" id="cb11-21" data-line-number="21">pow_tail &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22">replicates &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb11-23" data-line-number="23">power_out &lt;-<span class="st"> </span><span class="kw">sim_pow</span>(<span class="dt">fixed =</span> fixed, <span class="dt">random =</span> random, <span class="dt">random3 =</span> random3,</a>
<a class="sourceLine" id="cb11-24" data-line-number="24">                     <span class="dt">fixed_param =</span> fixed_param,</a>
<a class="sourceLine" id="cb11-25" data-line-number="25">                     <span class="dt">random_param =</span> random_param, </a>
<a class="sourceLine" id="cb11-26" data-line-number="26">                     <span class="dt">random_param3 =</span> random_param3,</a>
<a class="sourceLine" id="cb11-27" data-line-number="27">                     <span class="dt">cov_param =</span> cov_param,</a>
<a class="sourceLine" id="cb11-28" data-line-number="28">                     <span class="dt">k =</span> k, <span class="dt">n =</span> n, <span class="dt">p =</span> p,</a>
<a class="sourceLine" id="cb11-29" data-line-number="29">                     <span class="dt">error_var =</span> error_var, <span class="dt">with_err_gen =</span> <span class="st">&quot;rnorm&quot;</span>,</a>
<a class="sourceLine" id="cb11-30" data-line-number="30">                     <span class="dt">data_str =</span> data_str, </a>
<a class="sourceLine" id="cb11-31" data-line-number="31">                     <span class="dt">unbal =</span> <span class="kw">list</span>(<span class="dt">level2 =</span> <span class="ot">FALSE</span>, <span class="dt">level3 =</span> <span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb11-32" data-line-number="32">                     <span class="dt">pow_param =</span> pow_param, <span class="dt">alpha =</span> alpha,</a>
<a class="sourceLine" id="cb11-33" data-line-number="33">                     <span class="dt">pow_dist =</span> pow_dist, <span class="dt">pow_tail =</span> pow_tail, </a>
<a class="sourceLine" id="cb11-34" data-line-number="34">                     <span class="dt">replicates =</span> replicates)</a>
<a class="sourceLine" id="cb11-35" data-line-number="35"><span class="kw">head</span>(power_out)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 9
##   term  avg_test_stat sd_test_stat avg_std_err sd_std_err power num_reject
##   &lt;chr&gt;         &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
## 1 act            2.34       0.0151      0.0361   0.00136      0          0
## 2 actC~          6.81       0.369       0.252    0.0282       1          3
## 3 diff           6.01       0.0131      0.0250   0.000445     1          3
## 4 time           1.98       0.655       0.424    0.0980       0          0
## # ... with 2 more variables: num_repl &lt;dbl&gt;, data &lt;list&gt;</code></pre>
</div>
<div id="generalized-power-analysis" class="section level2">
<h2>Generalized Power Analysis</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">fixed &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>act <span class="op">+</span><span class="st"> </span>diff</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">fixed_param &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">cov_param &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">dist_fun =</span> <span class="kw">c</span>(<span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>),</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">                  <span class="dt">var_type =</span> <span class="kw">c</span>(<span class="st">&quot;single&quot;</span>, <span class="st">&quot;single&quot;</span>),</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">                  <span class="dt">opts =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">                              <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">4</span>)))</a>
<a class="sourceLine" id="cb13-7" data-line-number="7">n &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8">pow_param &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'(Intercept)'</span>, <span class="st">'act'</span>, <span class="st">'diff'</span>)</a>
<a class="sourceLine" id="cb13-9" data-line-number="9">alpha &lt;-<span class="st"> </span><span class="fl">.01</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10">pow_dist &lt;-<span class="st"> &quot;z&quot;</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11">pow_tail &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12">replicates &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"></a>
<a class="sourceLine" id="cb13-14" data-line-number="14">power_out &lt;-<span class="st"> </span><span class="kw">sim_pow_glm</span>(<span class="dt">fixed =</span> fixed, <span class="dt">fixed_param =</span> fixed_param, </a>
<a class="sourceLine" id="cb13-15" data-line-number="15">                         <span class="dt">cov_param =</span> cov_param, </a>
<a class="sourceLine" id="cb13-16" data-line-number="16">                         <span class="dt">n =</span> n, <span class="dt">data_str =</span> <span class="st">&quot;single&quot;</span>, </a>
<a class="sourceLine" id="cb13-17" data-line-number="17">                         <span class="dt">outcome_type =</span> <span class="st">'logistic'</span>,</a>
<a class="sourceLine" id="cb13-18" data-line-number="18">                         <span class="dt">pow_param =</span> pow_param, <span class="dt">alpha =</span> alpha,</a>
<a class="sourceLine" id="cb13-19" data-line-number="19">                         <span class="dt">pow_dist =</span> pow_dist, <span class="dt">pow_tail =</span> pow_tail, </a>
<a class="sourceLine" id="cb13-20" data-line-number="20">                         <span class="dt">replicates =</span> replicates)</a>
<a class="sourceLine" id="cb13-21" data-line-number="21"><span class="kw">head</span>(power_out)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 9
##   term  avg_test_stat sd_test_stat avg_std_err sd_std_err power num_reject
##   &lt;chr&gt;         &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;
## 1 (Int~        0.0569        0.392       0.378     0.0439     0          0
## 2 act          0.650         0.252       0.249     0.0595     0          0
## 3 diff         0.356         0.122       0.125     0.0287     0          0
## # ... with 2 more variables: num_repl &lt;dbl&gt;, data &lt;list&gt;</code></pre>
<div id="vary-arguments" class="section level3">
<h3>Vary Arguments</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">fixed &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>act <span class="op">+</span><span class="st"> </span>diff</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">fixed_param &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">cov_param &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">dist_fun =</span> <span class="kw">c</span>(<span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>),</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">                  <span class="dt">var_type =</span> <span class="kw">c</span>(<span class="st">&quot;single&quot;</span>, <span class="st">&quot;single&quot;</span>),</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">                  <span class="dt">opts =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">                              <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">8</span>)))</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">n &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8">pow_param &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'(Intercept)'</span>, <span class="st">'act'</span>, <span class="st">'diff'</span>)</a>
<a class="sourceLine" id="cb15-9" data-line-number="9">alpha &lt;-<span class="st"> </span><span class="fl">.01</span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10">pow_dist &lt;-<span class="st"> &quot;z&quot;</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11">pow_tail &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12">replicates &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13">terms_vary &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">100</span>),</a>
<a class="sourceLine" id="cb15-14" data-line-number="14">                   <span class="dt">fixed_param =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>), </a>
<a class="sourceLine" id="cb15-15" data-line-number="15">                                      <span class="kw">c</span>(<span class="fl">0.6</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>)))</a>
<a class="sourceLine" id="cb15-16" data-line-number="16"></a>
<a class="sourceLine" id="cb15-17" data-line-number="17">power_out &lt;-<span class="st"> </span><span class="kw">sim_pow_glm</span>(<span class="dt">fixed =</span> fixed, <span class="dt">fixed_param =</span> fixed_param, </a>
<a class="sourceLine" id="cb15-18" data-line-number="18">                         <span class="dt">cov_param =</span> cov_param, </a>
<a class="sourceLine" id="cb15-19" data-line-number="19">                         <span class="dt">n =</span> n, <span class="dt">data_str =</span> <span class="st">&quot;single&quot;</span>, </a>
<a class="sourceLine" id="cb15-20" data-line-number="20">                         <span class="dt">outcome_type =</span> <span class="st">'logistic'</span>,</a>
<a class="sourceLine" id="cb15-21" data-line-number="21">                         <span class="dt">pow_param =</span> pow_param, <span class="dt">alpha =</span> alpha,</a>
<a class="sourceLine" id="cb15-22" data-line-number="22">                         <span class="dt">pow_dist =</span> pow_dist, <span class="dt">pow_tail =</span> pow_tail, </a>
<a class="sourceLine" id="cb15-23" data-line-number="23">                         <span class="dt">replicates =</span> replicates, <span class="dt">terms_vary =</span> terms_vary)</a></code></pre></div>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<pre><code>## Warning: glm.fit: algorithm did not converge</code></pre>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">head</span>(power_out)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 11
## # Groups:   term, n [3]
##   term      n fixed_param avg_test_stat sd_test_stat avg_std_err sd_std_err
##   &lt;chr&gt; &lt;dbl&gt; &lt;fct&gt;               &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;
## 1 (Int~    20 0.5,0.1,0.2         0.581        0.650       0.828     0.357 
## 2 (Int~    20 0.6,0.1,0.2         8.61        24.4      6197.    19593.    
## 3 (Int~    40 0.5,0.1,0.2         0.503        0.578       0.448     0.0719
## 4 (Int~    40 0.6,0.1,0.2         0.631        0.532       0.456     0.0754
## 5 (Int~    60 0.5,0.1,0.2         0.375        0.265       0.334     0.0342
## 6 (Int~    60 0.6,0.1,0.2         0.578        0.353       0.360     0.0499
## # ... with 4 more variables: power &lt;dbl&gt;, num_reject &lt;dbl&gt;,
## #   num_repl &lt;dbl&gt;, data &lt;list&gt;</code></pre>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
