<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2017-05-25" />

<title>Simulate Missing Data</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Simulate Missing Data</h1>
<h4 class="date"><em>2017-05-25</em></h4>



<div id="missing-data" class="section level1">
<h1>Missing Data</h1>
<p>Missing data tends to be prolific in real world data, as such, it should also be included in any simulated data. This can help extend the external validity of the results based on simulated data. The <code>simglm</code> package builds this support directly into the simulation process. A master function, <code>missing_data</code>, takes a simulated data set and processes it to return missing data. The additional benefit to the <code>missing_data</code> function is that the original data remain and another variable is added to the simulated data that reflect the values that are assigned to a missing value. The ability for the researcher to check that the missing data was generated properly can be an important step.</p>
<div id="types-of-missing-data" class="section level2">
<h2>Types of Missing Data</h2>
<p>The modern missing data literature can be traced back to Rubin where he defined three different missing data mechanisms, missing completely at random (MCAR), missing at random (MAR), and not missing at random (NMAR). In general, if the missing data is either MCAR or MAR, unbiased estimates can be obtained, however, when the missing data is NMAR, bias can be introduced.</p>
<p>The <code>simglm</code> package currently supports simulation of MCAR and MAR mechanisms. Two MAR missing data mechanisms are currently built in, one being dropout missing data and another called <strong>mar</strong> missing data. Dropout missing data typically would be valid for longitudinal data and represents the situation where the respondent stops participating in the study. For example, they participate the first 3 weeks of the study, but move out of state after the third week and no further data is collected on that individual. The missing data for this type of individual is likely tied strictly to time, so therefore controlling for the time variable in the study would then lead to MAR missing data.</p>
<div id="dropout-missing-data-example" class="section level3">
<h3>Dropout Missing Data Example</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Simulate longitudinal data</span>
fixed &lt;-<span class="st"> </span><span class="er">~</span><span class="dv">1</span> +<span class="st"> </span>time +<span class="st"> </span>diff +<span class="st"> </span>act +<span class="st"> </span>time:act
random &lt;-<span class="st"> </span><span class="er">~</span><span class="dv">1</span> +<span class="st"> </span>time +<span class="st"> </span>diff
fixed_param &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">6</span>, <span class="fl">2.3</span>, <span class="dv">7</span>)
random_param &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">random_var =</span> <span class="kw">c</span>(<span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">2</span>), <span class="dt">rand_gen =</span> <span class="st">&quot;rnorm&quot;</span>)
cov_param &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">dist_fun =</span> <span class="kw">c</span>(<span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>),
                  <span class="dt">var_type =</span> <span class="kw">c</span>(<span class="st">&quot;level1&quot;</span>, <span class="st">&quot;level2&quot;</span>),
                  <span class="dt">opts =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="fl">1.5</span>),
                              <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">4</span>)))
n &lt;-<span class="st"> </span><span class="dv">150</span>
p &lt;-<span class="st"> </span><span class="dv">30</span>
error_var &lt;-<span class="st"> </span><span class="dv">4</span>
with_err_gen &lt;-<span class="st"> 'rnorm'</span>
data_str &lt;-<span class="st"> &quot;long&quot;</span>
temp_long &lt;-<span class="st"> </span><span class="kw">sim_reg</span>(fixed, random, <span class="dt">random3 =</span> <span class="ot">NULL</span>, fixed_param,
                     random_param, <span class="dt">random_param3 =</span> <span class="ot">NULL</span>,
                     cov_param, <span class="dt">k =</span> <span class="ot">NULL</span>, n, p, error_var, 
                     with_err_gen, <span class="dt">data_str =</span> data_str)

<span class="co"># simulate missing data</span>
temp_long_miss &lt;-<span class="st"> </span><span class="kw">missing_data</span>(temp_long, <span class="dt">miss_prop =</span> .<span class="dv">25</span>, 
                               <span class="dt">type =</span> <span class="st">'dropout'</span>, 
                               <span class="dt">clust_var =</span> <span class="st">'clustID'</span>, 
                               <span class="dt">within_id =</span> <span class="st">'withinID'</span>)
<span class="kw">head</span>(temp_long_miss)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">X.Intercept.</th>
<th align="right">time</th>
<th align="right">diff</th>
<th align="right">act</th>
<th align="right">time.act</th>
<th align="right">b0</th>
<th align="right">b1</th>
<th align="right">b2</th>
<th align="right">Fbeta</th>
<th align="right">randEff</th>
<th align="right">err</th>
<th align="right">sim_data</th>
<th align="right">withinID</th>
<th align="right">clustID</th>
<th align="right">missing</th>
<th align="right">sim_data2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0.4037973</td>
<td align="right">3.545604</td>
<td align="right">0.000000</td>
<td align="right">2.844407</td>
<td align="right">2.110961</td>
<td align="right">-1.234144</td>
<td align="right">14.57767</td>
<td align="right">2.346063</td>
<td align="right">-2.4185070</td>
<td align="right">14.50523</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">14.50523</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1.4335717</td>
<td align="right">3.545604</td>
<td align="right">3.545604</td>
<td align="right">2.844407</td>
<td align="right">2.110961</td>
<td align="right">-1.234144</td>
<td align="right">47.57555</td>
<td align="right">3.186134</td>
<td align="right">1.0903738</td>
<td align="right">51.85205</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">51.85205</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0.9506774</td>
<td align="right">3.545604</td>
<td align="right">7.091208</td>
<td align="right">2.844407</td>
<td align="right">2.110961</td>
<td align="right">-1.234144</td>
<td align="right">71.49741</td>
<td align="right">5.893056</td>
<td align="right">0.1327094</td>
<td align="right">77.52317</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">77.52317</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">-0.5171727</td>
<td align="right">3.545604</td>
<td align="right">10.636812</td>
<td align="right">2.844407</td>
<td align="right">2.110961</td>
<td align="right">-1.234144</td>
<td align="right">89.50954</td>
<td align="right">9.815555</td>
<td align="right">-1.9452815</td>
<td align="right">97.37981</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">97.37981</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1.1441603</td>
<td align="right">3.545604</td>
<td align="right">14.182416</td>
<td align="right">2.844407</td>
<td align="right">2.110961</td>
<td align="right">-1.234144</td>
<td align="right">126.29676</td>
<td align="right">9.876192</td>
<td align="right">1.6888111</td>
<td align="right">137.86176</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">137.86176</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">5</td>
<td align="right">-0.7044968</td>
<td align="right">3.545604</td>
<td align="right">17.728020</td>
<td align="right">2.844407</td>
<td align="right">2.110961</td>
<td align="right">-1.234144</td>
<td align="right">142.02405</td>
<td align="right">14.268661</td>
<td align="right">-1.8637208</td>
<td align="right">154.42899</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">154.42899</td>
</tr>
</tbody>
</table>
<p>From the example above, first two level longitudinal data are simulated. Then the <code>missing_data</code> function is used to generate the missing data. The function call includes the data frame to generate missing data, the proportion of values that are missing (in this case approximately 25% of the data will be identified as missing), the type is dropout, and the cluster ID variable is named as ‘clustID’. The output shows that two additional variables are added, a dichotomous variable reflecting whether the outcome is missing (a value of 1) or not (0) and a new outcome variable (labeled as <em>sim_data2</em>) to reflect the new outcome with missing data. To verify that indeed about 25% of the data are now missing:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.table</span>(<span class="kw">table</span>(temp_long_miss$missing))</code></pre></div>
<pre><code>## 
##         0         1 
## 0.7488889 0.2511111</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.table</span>(<span class="kw">table</span>(<span class="kw">is.na</span>(temp_long_miss$sim_data2)))</code></pre></div>
<pre><code>## 
##     FALSE      TRUE 
## 0.7488889 0.2511111</code></pre>
</div>
<div id="mar-missing-data-example" class="section level3">
<h3>MAR Missing Data Example</h3>
<p>The mar missing data is similar to that of dropout missing data, but instead of being conditional on time, a third variable can be added to base the missing data on. For example, in a study, perhaps those individuals with lower income are less likely to report the outcome of the study. As such, the mar missing data implementation in <code>simglm</code> allows you to simulate missing data in a similar framework as the example above. Below is an example from a single level regression (assuming that the covariates are grand mean centered).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># simulate data</span>
fixed &lt;-<span class="st"> </span><span class="er">~</span><span class="dv">1</span> +<span class="st"> </span>age +<span class="st"> </span>income
fixed_param &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="fl">0.3</span>, <span class="fl">1.3</span>)
cov_param &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">dist_fun =</span> <span class="kw">c</span>(<span class="st">'rnorm'</span>, <span class="st">'rnorm'</span>), 
                  <span class="dt">var_type =</span> <span class="kw">c</span>(<span class="st">&quot;single&quot;</span>, <span class="st">&quot;single&quot;</span>),
                  <span class="dt">opts =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">4</span>),
                              <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">3</span>)))
n &lt;-<span class="st"> </span><span class="dv">150</span>
error_var &lt;-<span class="st"> </span><span class="dv">3</span>
with_err_gen &lt;-<span class="st"> 'rnorm'</span>
temp_single &lt;-<span class="st"> </span><span class="kw">sim_reg</span>(<span class="dt">fixed =</span> fixed, <span class="dt">fixed_param =</span> fixed_param,
                       <span class="dt">cov_param =</span> cov_param,
                       <span class="dt">n =</span> n, <span class="dt">error_var =</span> error_var, <span class="dt">with_err_gen =</span> with_err_gen,
                       <span class="dt">data_str =</span> <span class="st">&quot;single&quot;</span>)

<span class="co"># generate missing data</span>
miss_prop &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.45</span>, <span class="fl">0.4</span>, <span class="fl">0.35</span>, <span class="fl">0.3</span>, <span class="fl">0.25</span>, <span class="fl">0.2</span>, <span class="fl">0.15</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span>)
miss_prop &lt;-<span class="st"> </span><span class="kw">rep</span>(miss_prop, <span class="dt">each =</span> <span class="dv">15</span>)
tmp_single_miss &lt;-<span class="st"> </span><span class="kw">missing_data</span>(temp_single, <span class="dt">miss_prop =</span> miss_prop, 
                                <span class="dt">type =</span> <span class="st">'mar'</span>, <span class="dt">miss_cov =</span> <span class="st">'income'</span>)
<span class="kw">head</span>(tmp_single_miss)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">income</th>
<th align="right">X.Intercept.</th>
<th align="right">age</th>
<th align="right">Fbeta</th>
<th align="right">err</th>
<th align="right">sim_data</th>
<th align="right">ID</th>
<th align="right">miss_prop</th>
<th align="right">miss_prob</th>
<th align="right">sim_data2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-7.788367</td>
<td align="right">1</td>
<td align="right">3.014433</td>
<td align="right">-7.220548</td>
<td align="right">-1.8016414</td>
<td align="right">-9.022189</td>
<td align="right">32</td>
<td align="right">0.5</td>
<td align="right">0.9046185</td>
<td align="right">-9.022189</td>
</tr>
<tr class="even">
<td align="right">-6.755479</td>
<td align="right">1</td>
<td align="right">-5.762943</td>
<td align="right">-8.511005</td>
<td align="right">0.4296415</td>
<td align="right">-8.081364</td>
<td align="right">146</td>
<td align="right">0.5</td>
<td align="right">0.1320079</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">-6.615884</td>
<td align="right">1</td>
<td align="right">-2.245223</td>
<td align="right">-7.274216</td>
<td align="right">1.4919684</td>
<td align="right">-5.782248</td>
<td align="right">45</td>
<td align="right">0.5</td>
<td align="right">0.8881772</td>
<td align="right">-5.782248</td>
</tr>
<tr class="even">
<td align="right">-6.580433</td>
<td align="right">1</td>
<td align="right">2.126600</td>
<td align="right">-5.916583</td>
<td align="right">-2.1026910</td>
<td align="right">-8.019274</td>
<td align="right">73</td>
<td align="right">0.5</td>
<td align="right">0.5476774</td>
<td align="right">-8.019274</td>
</tr>
<tr class="odd">
<td align="right">-6.350942</td>
<td align="right">1</td>
<td align="right">-1.423969</td>
<td align="right">-6.683415</td>
<td align="right">-1.6901548</td>
<td align="right">-8.373570</td>
<td align="right">15</td>
<td align="right">0.5</td>
<td align="right">0.1789071</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">-6.320616</td>
<td align="right">1</td>
<td align="right">1.591960</td>
<td align="right">-5.739213</td>
<td align="right">-0.4768309</td>
<td align="right">-6.216044</td>
<td align="right">42</td>
<td align="right">0.5</td>
<td align="right">0.3681470</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>First single level data are simulated for 150 individuals. Missing proportions are then generated. In this example, 10 different proportions are created in decreasing order. This is important as the data generation arranges the covariate from smallest to largest. Then the missing proportions are repeated so that the <code>miss_prop</code> vector is the same length as the number of individuals. The second new addition is the argument <code>miss_cov</code>, this is the covariate that is used to generate the missing data. In this example, the covariate <em>income</em> is used.</p>
<p>Three additional variables are added in this function, <strong>miss_prop</strong>, <strong>miss_prob</strong>, and <strong>sim_data2</strong> which reflect the missing proportion, the missing probability, and the new simulated data with missing data included. The missing data are generated if the <strong>miss_prob</strong> variable is greater than <strong>miss_prop</strong>, then the value is NA, otherwise it is not. The percentages can be summarized with the following table to show the structure of missing data depends on the variable <strong>income</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(tmp_single_miss$miss_prop,<span class="kw">is.na</span>(tmp_single_miss$sim_data2))</code></pre></div>
<pre><code>##       
##        FALSE TRUE
##   0.05    15    0
##   0.1     15    0
##   0.15    13    2
##   0.2     15    0
##   0.25    11    4
##   0.3     12    3
##   0.35    11    4
##   0.4      9    6
##   0.45     8    7
##   0.5      6    9</code></pre>
</div>
</div>
<div id="mcar-missing-data-example" class="section level2">
<h2>MCAR Missing Data Example</h2>
<p>Missing completely at random is also included in the package, and can be called with the <code>missing_data</code> function with <code>type = 'random'</code>. Using the single level example from above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tmp_single_miss &lt;-<span class="st"> </span><span class="kw">missing_data</span>(temp_single, <span class="dt">miss_prop =</span> .<span class="dv">25</span>, 
                                <span class="dt">type =</span> <span class="st">'random'</span>, <span class="dt">clust_var =</span> <span class="ot">NULL</span>)
<span class="kw">head</span>(tmp_single_miss)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">X.Intercept.</th>
<th align="right">age</th>
<th align="right">income</th>
<th align="right">Fbeta</th>
<th align="right">err</th>
<th align="right">sim_data</th>
<th align="right">ID</th>
<th align="right">miss_prob</th>
<th align="right">missing</th>
<th align="right">sim_data2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">-3.8798251</td>
<td align="right">6.6181555</td>
<td align="right">9.439655</td>
<td align="right">0.5437035</td>
<td align="right">9.9833581</td>
<td align="right">1</td>
<td align="right">0.045</td>
<td align="right">1</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">-0.2677956</td>
<td align="right">-3.4265463</td>
<td align="right">-2.534849</td>
<td align="right">0.0677233</td>
<td align="right">-2.4671255</td>
<td align="right">2</td>
<td align="right">0.336</td>
<td align="right">0</td>
<td align="right">-2.4671255</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">-1.0232660</td>
<td align="right">3.1575189</td>
<td align="right">5.797795</td>
<td align="right">-0.4209826</td>
<td align="right">5.3768121</td>
<td align="right">3</td>
<td align="right">0.881</td>
<td align="right">0</td>
<td align="right">5.3768121</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1.0593893</td>
<td align="right">-0.8802657</td>
<td align="right">1.173471</td>
<td align="right">-2.1607687</td>
<td align="right">-0.9872973</td>
<td align="right">4</td>
<td align="right">0.296</td>
<td align="right">0</td>
<td align="right">-0.9872973</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">4.4755166</td>
<td align="right">-4.3622470</td>
<td align="right">-2.328266</td>
<td align="right">0.4123706</td>
<td align="right">-1.9158956</td>
<td align="right">5</td>
<td align="right">0.769</td>
<td align="right">0</td>
<td align="right">-1.9158956</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">-5.0439098</td>
<td align="right">0.6649162</td>
<td align="right">1.351218</td>
<td align="right">-1.5262884</td>
<td align="right">-0.1750703</td>
<td align="right">6</td>
<td align="right">0.069</td>
<td align="right">1</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>When generating missing data from a single level data set, the <code>clust_var</code> argument must be set to <code>NULL</code>. The rest of the function call is very similar to past calls to the <code>missing_data</code> function. Three additional variables are created, <strong>miss_prob</strong>, <strong>missing</strong>, and <strong>sim_data2</strong> which reflect the missing probability, a dichotomous missing variable, and the new generated missing data. The data is generated as missing if the <strong>miss_prob</strong> variable is less than the miss_prop argument above (0.25 in this case).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.table</span>(<span class="kw">table</span>(<span class="kw">is.na</span>(tmp_single_miss$sim_data2)))</code></pre></div>
<pre><code>## 
##     FALSE      TRUE 
## 0.7466667 0.2533333</code></pre>
<!--
Data can also be simulated as MCAR at the cluster level. Using the longitudinal example from above.


-->
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
